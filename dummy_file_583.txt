Commit 583 on 2023-11-04 22:09:27: Refactored code